<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <title>LSDog ~ æ¬¢è¿å…‰ä¸´ ãƒ¾(â‰§â–½â‰¦*)o</title>

    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">

    <meta name="keywords" content="LSDog,LSDogX,LSDog.fun,ç¬‘å¤©çŠ¬">
    <meta name="description" content="A website about LSDog">
    <meta name="author" content="LSDog">

    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="font.css">

    <style>
        body {
            background-color: black;
            color: white;
        }
    </style>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.5">

    <script>
        log = console.log;
    </script>

</head>

<body>

    <div id="bg">

    </div>


    <!-- éå¸¸ä¾¿æ·ç®€çº¦çš„ è¯­æ³•å¡«ç©ºç»ƒä¹ ï¼å¯ä»¥ç›´æ¥æ‹¿èµ°å¤åˆ¶ç²˜è´´æ”¾åˆ°è‡ªå·±çš„ç½‘ç«™ï¼Œéå¸¸æ–¹ä¾¿ï¼(ä¸è¿‡è®°å¾—è¿˜è¦ä¸‹è½½ cloze_questions.json æ”¾åˆ°æ ¹ç›®å½•)-->
    <div id="cloze" style="display: block; width: 70%; max-width: 1024px; border-radius: 0.5em; left: 0; right: 0; 
        margin: 1em auto 1em auto; padding: 0.5em 1em 1.5em 1em; color: teal; font-size: 1em;
        background-color: ghostwhite; background: linear-gradient(120deg, #f5dbed 0%, #d2dbeb 100%);">

        <!-- simple-keyboard è™šæ‹Ÿé”®ç›˜æ ·å¼è¡¨ / js -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/css/index.css">
        <script src="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/index.js"></script>

        <!-- æ ·å¼ -->
        <style>
            /* è™šæ‹Ÿé”®ç›˜ */
            .simple-keyboard {
                max-width: 800px;
                margin: 0 auto;
            }

            .simple-keyboard .hg-button.hg-functionBtn.hg-button-space {
                min-width: 150px;
            }

            .simple-keyboard .hg-button-numbers {
                max-width: 80px;
            }

            .simple-keyboard .hg-button.hg-functionBtn.hg-button-enter {
                max-width: 100px;
            }

            .simple-keyboard .hg-button.hg-functionBtn.hg-button-n_enter {
                max-width: 100px;
            }

            #cloze_question {
                font-family: Arial, Helvetica, sans-serif;
                font-size: 1.8em;
            }

            /* å…ƒç´  */
            #cloze_answer {
                width: 9em;
                font-size: 1.5em;
                border: 1px solid darkblue;
                border-radius: 3px;
            }

            #cloze_ans {
                visibility: hidden;
                color: mediumslateblue;
                opacity: 1;
                line-height: 1.5em;
                font-size: 1.2em;
                padding: 0.3em;
                font-family: Arial, Helvetica;
                border-color: mediumseagreen;
                border-width: 5px;
                border-style: solid;
                border-top: 1px solid gray;
                border-bottom: 1px solid gray;
            }
        </style>

        <!-- æ ‡é¢˜ -->
        <h1>Cloze - éšæœºè¯­æ³•å¡«ç©º</h1>
        <hr />

        <!-- ç­”é¢˜åŒº -->
        <div>
            <h3 id="cloze_question">[QUESTION]</h3>
            <a style="font-size: 1.5em;">ä½ çš„ç­”æ¡ˆ: </a><input type="text" id="cloze_answer" autocomplete="new-password"
                tabindex="-1" />
            <br />
            <div style="font-size: 0.6em;">çŠ¶æ€: <a id="cloze_state"></a></div>
            <div style="font-size: 0.6em;">è·³è½¬åˆ°ç¬¬ <input type="text" id="cloze_goto" style="width: 3em;"
                    autocomplete="new-password" tabindex="-1"> é¢˜.</div>
        </div>
        <br />

        <!-- ç­”æ¡ˆåŒº -->
        <div id="cloze_ans" style="visibility: hidden">
            <div id="cloze_ans_right" style="background-color: #80808005; display:inline-block; font-weight: 700"></div>
            <b>æ˜¯ <a id="cloze_ans_A" style="color: seagreen"></a> !</b>
            <div style="background-color: #80808010">ğŸ“œ&ensp;<a id="cloze_ans_Q" style="font-weight: 600"></a></div>
            <div style="background-color: #80808005">ğŸ“‘&ensp;<a id="cloze_ans_ana"></a></div>
            <div style="background-color: #80808010">ğŸ“Œ&ensp;<a id="cloze_ans_tags"></a></div>
        </div>
        <br />

        <!-- è™šæ‹Ÿé”®ç›˜ -->
        <div class="simple-keyboard"></div>
        <br />

        <!-- tip -->
        <div style="display: block; padding: 0; font-size: 0.8em; float: left;">å›è½¦å³å¯ã€æäº¤ã€‘ï¼Œå†æ¬¡å›è½¦è¿›å…¥ä¸‹ä¸€é¢˜ï¼</div>
        <div style="display: block; padding: 0; font-size: 0.8em; float: right;">Made by LSDog</div>

        <!-- script -->
        <script>

            cloze_state.innerText = "åˆå§‹åŒ–...";
            var cloze_questions;
            var cloze_count;
            var cloze_current;
            var cloze_current_number;
            var cloze_answered = false;
            var cloze_vertical = false;

            /* åŠ¨æ€è°ƒæ•´ï¼šå¦‚æœæ˜¯ "ç«–å±"ï¼Œå¢åŠ å®½åº¦ï¼Œå‡å°‘å­—ä½“å¤§å° */
            let autoResize = () => {
                if (window.innerWidth < window.innerHeight) {
                    if (!cloze_vertical) {
                        cloze_vertical = true;
                        cloze.style.width = "90%";
                        cloze.style.fontSize = "0.8em";
                    }
                } else {
                    if (cloze_vertical) {
                        cloze_vertical = false;
                        cloze.style.width = "70%";
                        cloze.style.fontSize = "1em";
                    }
                }
            }
            autoResize();
            window.onresize = autoResize;

            /* æ–°éšæœºé¢˜ */
            function newRandomCloze() {
                let newNumber;
                if (cloze_count > 1) { // é˜²æ­¢jsonå°±ç•™ä¸€é¢˜å¯¼è‡´å¡æ­»
                    newNumber = cloze_current_number;
                    while (cloze_current_number == newNumber) {
                        newNumber = randomInt(cloze_count);
                    }
                } else {
                    newNumber = randomInt(cloze_count);
                }
                return newCloze(newNumber);
            }

            /* æ¢åˆ°ç¬¬ cloze_number ä¸ªé¢˜ */
            function newCloze(cloze_number) {
                cloze_number = Math.min(cloze_count - 1, cloze_number);
                cloze_number = Math.max(0, cloze_number);
                cloze_current_number = cloze_number;
                cloze_ans.style.opacity = 0.2; // ç­”æ¡ˆåŒºé€æ˜(å‡æ·¡)
                cloze_current = cloze_questions[cloze_current_number]; // æ”¾åˆ°å½“å‰é¢˜ç›®ä¸­
                cloze_state.innerText = "(éšæœº)é¢˜ç›®: " + (cloze_current_number + 1) + " of " + cloze_count + " in total."; // æ›´æ–°ä¿¡æ¯
                cloze_question.innerText = cloze_current.Q; // å°†é¢˜ç›®å†™è¿›å»
                cloze_answered = false;
            }

            /* åˆ¤é¢˜ */
            function checkAnswer() {
                if (cloze_current == null) return;
                if (cloze_ans.style.visibility == "hidden") {
                    cloze_ans.style.visibility = "visible";
                }
                cloze_answered = true;
                cloze_ans.style.opacity = 1;
                let correct = (cloze_current.A.indexOf(cloze_answer.value) > -1); // ç­”æ¡ˆåˆ—è¡¨é‡ŒåŒ…å«è¾“å…¥ç­”æ¡ˆ
                cloze_ans_right.innerText = correct ? "ğŸ™†â€â™€ï¸ æ­£ç¡®ï¼" : "ğŸ™…â€â™€ï¸  é”™è¯¯ï¼";
                cloze_ans_right.style.color = correct ? "green" : "inherit";
                cloze_ans_Q.innerText = cloze_current.Q;
                cloze_ans_A.innerText = cloze_current.A.join(" æˆ– ");
                cloze_ans_ana.innerText = cloze_current.ana;
                cloze_ans_tags.innerText = cloze_current.tags.join();
                cloze_ans.style.opacity = 1; // ç­”æ¡ˆåŒºæ¢å¤ä¸é€æ˜
            }

            /* å¤„ç†ç­”é¢˜æ¡†è¾“å…¥ (ç›´æ¥è¾“å…¥/è™šæ‹Ÿé”®ç›˜) [è¿”å› boolean:æ˜¯å¦å–æ¶ˆäº‹ä»¶] */
            function handleAnswerInput(key) {
                if (!cloze_answered) {
                    // è‹¥æ˜¯å›è½¦å…ˆç­”é¢˜
                    if (key.toLowerCase().includes("enter")) checkAnswer();
                    return false;
                } else {
                    // è‹¥ç­”å®Œé¢˜(å·²æ˜¾ç¤ºç­”æ¡ˆ) è¾“å…¥ä»»ä½•å­—éƒ½åˆ‡æ–°é¢˜
                    cloze_answer.value = "";
                    newRandomCloze();
                    return true;
                }
            }

            /* éšæœºæ•´æ•° */
            function randomInt(start, end) {
                if (end == null) {
                    end = start;
                    start = 0;
                }
                return Math.floor((end - start) * Math.random() + start);
            }

            /* ç­”é¢˜è¾“å…¥æ¡†çš„æŒ‰é”®äº‹ä»¶å¤„ç† */
            cloze_answer.onkeydown = (e) => {
                if (handleAnswerInput(e.key)) {
                    e.preventDefault();
                }
                vKeyboard.setInput(cloze_answer.value);
            }

            /* è·³è½¬é¢˜ç›®è¾“å…¥æ¡†çš„äº‹ä»¶å¤„ç† */
            cloze_goto.onkeydown = (e) => {
                if (e.key == "Enter") {
                    if (cloze_goto.value == "") return;
                    let num = parseInt(cloze_goto.value);
                    if (num == NaN) return;
                    num--;
                    num = Math.max(0, num);
                    num = Math.min(cloze_count - 1, num);
                    newCloze(num);
                    cloze_answer.value = "";
                    cloze_answer.focus();
                    cloze_goto.value = "";
                }
            }
            cloze_goto.oninput = (e) => { // è·³è½¬æ¡†åªå…è®¸æ•°å­—è¾“å…¥
                if (e.data != null && ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(e.data) < 0) {
                    cloze_goto.value = cloze_goto.value.substring(0, cloze_goto.value.length - e.data.length);
                }
            }

            /* åŠ è½½é¢˜ç›® */
            cloze_state.innerText = "æ­£åœ¨åŠ è½½é¢˜ç›®...";
            var request = new XMLHttpRequest();
            request.open("get", "cloze_questions.json");
            request.send(null);
            request.onload = () => {
                cloze_state.innerText = "æ­£åœ¨è§£æé¢˜ç›®...";
                //log(decodeURIComponent(encodeURIComponent(request.responseText)));
                cloze_questions = JSON.parse(request.responseText).questions;
                cloze_count = cloze_questions.length
                cloze_state.innerText = "åŠ è½½å®Œæˆ! æ€»é¢˜ç›®æ•°é‡: " + cloze_count;
                newRandomCloze();
            }

            /* è®¾ç½®è™šæ‹Ÿé”®ç›˜ */
            const Keyboard = window.SimpleKeyboard.default;
            const vKeyboard = new Keyboard({
                /* è¾“å…¥ */
                onChange: input => {
                    cloze_answer.value = input;
                },
                /* æŒ‰é”® */
                onKeyPress: button => {
                    switch (button) {
                        case "{shift}":
                        case "{lock}":
                            let currentLayout = vKeyboard.options.layoutName;
                            let shiftToggle = currentLayout === "default" ? "shift" : "default";
                            vKeyboard.setOptions({
                                layoutName: shiftToggle
                            });
                            break;
                        default:
                            if (handleAnswerInput(button)) {
                                vKeyboard.setInput("");
                                cloze_answer.value = "";
                            }
                    }
                },
                mergeDisplay: true,
                layoutName: "default",
                layout: {
                    default: [
                        "q w e r t y u i o p",
                        "a s d f g h j k l",
                        "{shift} z x c v b n m {backspace}",
                        "{n_enter} {space} {enter}"
                    ],
                    shift: [
                        "Q W E R T Y U I O P",
                        "A S D F G H J K L",
                        "{shift} Z X C V B N M {backspace}",
                        "{n_enter} {space} {enter}"
                    ]
                },
                display: {
                    "{backspace}": "â†",
                    "{shift}": "â‡§",
                    "{enter}": "æäº¤",
                    "{n_enter}": "ä¸‹ä¸€é¢˜"
                }
            });
        </script>
    </div>

    <div style="display: block; width: 400px; text-align: center; background: linear-gradient(#d2dbeb3a, #d2dbeb00); margin: auto; padding: 5px; border-radius: 10px 10px;">
        <div style="text-align: center; font-size: 1.2em;"> <b>Cloze</b> çš„ç®€æ˜ä½¿ç”¨æ•™ç¨‹ï¼š </div>
        <br />
        <div style="text-align: left; line-height: 150%;">
            â… . è¯»é¢˜ â€”â€” æ ¹æ®æ‹¬å·æç¤ºæƒ³å‡ºåˆé€‚çš„ç­”æ¡ˆæ¥ï¼<br />
            â…¡. è¾“å…¥ â€”â€” ç‚¹å‡» â€œä½ çš„ç­”æ¡ˆï¼šâ€ å³ä¾§çš„è¾“å…¥æ¡†ï¼Œç„¶åç”¨ä½ è‡ªå·±çš„é”®ç›˜è¾“å…¥ï¼â€”â€” æˆ–è€…ä½¿ç”¨å±å¹•ä¸Šçš„è™šæ‹Ÿé”®ç›˜è¾“å…¥ï¼<br />
            â…¢. æäº¤ â€”â€” æ•²å‡»å›è½¦ï¼Œæˆ–è€…ç‚¹å‡»è™šæ‹Ÿé”®ç›˜çš„ â€œæäº¤â€ æ¥æ£€æŸ¥ä½ çš„ç­”æ¡ˆï¼<br />
            â…£. ç»§ç»­ â€”â€” å†æ¬¡æ•²å‡»å›è½¦ï¼Œæˆ–è€…ç‚¹å‡» â€œä¸‹ä¸€é¢˜â€ æ˜¾ç¤ºæ–°çš„é¢˜ç›®~ <br />
        </div>
    </div>
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />

    <div id="FunkyTownRotater" style="display: block; width: 70%; max-width: 1024px; border-radius: 0.5em; left: 0; right: 0;
        margin: 1em auto 1em auto; padding: 0.5em 1em 1em 1em; object-fit: contain;
        color: teal; font-size: 1.5em;background-color: ghostwhite;">
        <h2>FunkyTownRotater - ä½ å–œæ¬¢çš„æ—‹è½¬</h2>
        <hr />
        <!--éŸ³ä¹åŒº-->
        <div style="font-size: 0.8em">
            <audio id="rotate_music" src="sound/FunkyTown.mp3" type="audio/mpeg"></audio>
            æ”¾å°æ›²å„¿ <input id="rotate_check" type="checkbox"
                style="width: 1em; height: 1em; background-color:darkcyan" /><br>
        </div>
        <!--æ—‹è½¬åŒº-->
        <div id="rotater">
            <img id="rotator" src="img/NVGNGYU.webp"
                style="position: relative; display: block; max-height: 500px;
                object-fit: contain; max-width: 100%; bottom: 0px; filter: drop-shadow(0px -10px 1px gray); transform: rotateY(0deg)" />
        </div>
        ä¸Šä¼ ä½ ä¸­æ„çš„å›¾ç‰‡ <input id="rotate_upload" type="file" accept="image/*" />
        <script>
            rotator_degree = 0;
            /* æ”¾å°æ›²å„¿ */
            rotate_check.onclick = () => {
                if (rotate_check.checked) {
                    rotate_music.play();
                } else {
                    rotate_music.pause();
                    //rotate_music.currentTime = 0;
                }
            }
            rotate_music.onended = () => { rotate_music.currentTime = 0; rotate_music.play(); }
            /* ä¸Šä¼ æ–‡ä»¶ */
            rotate_upload.onchange = () => {
                const files = rotate_upload.files;
                if (files.length == 0) return;
                rotator.src = URL.createObjectURL(files[0]);
            }
            /* æ—‹è½¬åŠ¨ç”» */
            setInterval(() => {
                if (!rotate_music.paused) {
                    rotator_degree = rotator_degree < 360 ? rotator_degree + 3 : 0;
                    rotator.style.transform = "rotateY(" + rotator_degree + "deg)";
                    rotator.style.bottom = Math.sin(Date.now() / 400.0) * 10.0 + "px";
                    //rotator.style.filter = "drop-shadow(0px "+(parseInt(rotator.style.bottom)-10)+"px 1px gray)";
                }
            }, 16.25);
        </script>
    </div>

    <br><br><br><br><br><br><br><br>

    <div id="title" class="title" style="visibility: visible;">

        <div id="title_close" style="position: absolute; right: 0; font-size: 2em; font-weight: 900;">[X]</div>

        <h1>
            <a style="text-decoration: underline;" onclick="toggleVisibleWithFade('about', 0.8);">LSDog's</a> websh_t
        </h1>
        <h2>Enjoy for nothing.</h2>

        <div id="about" class="about" style="border-radius: 0.5em; backdrop-filter: blur(8px);"
            onclick="toggleVisibleWithFade('about', 1);">
            Hi! Im LSDog for sure~ <br>
            <a href="https://github.com/LSDogX" target="_blank" style="color: white;">Github</a> ~ <a
                href="https://gitee.com/LSDog" target="_blank" style="color: white;">Gitee</a>
        </div>

        <script>
            autoResize = () => {
                if (window.innerWidth < window.innerHeight) { // å¦‚æœæ˜¯ "ç«–å±"ï¼Œå°†æ ‡ç­¾æ”¾å°
                    if (title.style.fontSize != "0.6em") title.style.fontSize = "0.6em";
                } else {
                    if (title.style.fontSize != "1em") title.style.fontSize = "1em";
                }
            }
            autoResize();
            title.onresize = autoResize();
            title_close.onclick = () => {
                title.style.visibility = "hidden";
            }
        </script>

    </div>

    <script src="js/script.js"></script>

</body>